# Projet de Trading Algorithmique Quantitatif

Ce projet vise à développer un système de trading algorithmique pour les cryptomonnaies, en passant par plusieurs sprints de développement, de la collecte de données à l'exécution en production.

## Environnement et Configuration

*   **`config.py`**: Charge les variables d'environnement (clés API Binance, CryptoPanic) depuis un fichier `.env` et fournit des clients pour interagir avec l'API Binance (REST et WebSocket). *Aucun lancement direct.*

## Sprint S1 - Collecte des Données Historiques

| Fichier             | Rôle dans l’architecture                                                                                                                                                                                              | Commandes clés                                                                                                                                                                                             |
| :------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`historical.py`** | Télécharge l’historique des chandeliers pour une **paire spécifiée** (ex: `BTCUSDC`), un **intervalle** (ex: `1h`) et un nombre de **jours** (ex: `365`). Enregistre les données en **Parquet** avec la date de génération dans le nom (ex: `data/btcusdc_1h_365d_YYMMDD.parquet`). Gère la pagination de l'API. | ```bash # Pour BTCUSDT, intervalle 15m, sur les 90 derniers jours: ``` <br> ```python S1/historical.py --symbol BTCUSDT --interval 15m --days 90``` <br> *(Le nom du fichier inclura la date du jour, ex: `..._90d_240528.parquet`)* |
| `streamer.py`       | Écoute le flux WebSocket **kline 1 min** pour une **paire spécifiée** (défaut: `BTCUSDT`) en temps réel. Insère/met à jour les bougies dans un fichier **SQLite dédié** (ex: `data/btcusdt_1m_realtime.db`).             | ```bash # Pour BTCUSDT (défaut):``` <br> ```python S1/streamer.py``` <br><br> ```bash # Pour ETHUSDC:``` <br> ```python S1/streamer.py --symbol ETHUSDC``` <br> *(boucle continue, Ctrl‑C pour arrêter)* |
| `visualize_price_volume.ipynb` | Notebook Jupyter pour visualiser interactivement le **prix de clôture** et le **volume** à partir des fichiers Parquet (format `symbole_intervalle_joursd_YYMMDD.parquet`) générés par `historical.py`. Permet de sélectionner le fichier de données et une plage de dates. | Ouvrir et exécuter les cellules dans Jupyter Notebook/Lab.<br>Ex : `jupyter notebook S1/notebooks/visualize_price_volume.ipynb` |
| `tests/test_S1.py`  | Tests (pytest) pour S1 :<br>• Vérifie la création et la structure de base du fichier Parquet (incluant la date) généré par `historical.py`.<br>• Vérifie la création du fichier SQLite et la structure de la table `kline` par `streamer.py`. | ```pytest tests/test_S1.py``` <br>ou ```pytest tests/```                                                                                                                                     |

## Sprint S2 - Calcul des Indicateurs Techniques et Visualisation

| Fichier                 | Objectif / Rôle                                                                                                                                                                                                                                     | Commande principale                                                                                                                                                                                                                                                                                                                                                                                                                                |
| :---------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`indicators.py`**     | *Pipeline* : **Scanne le répertoire `data/`** pour tous les fichiers Parquet de chandeliers (ex: `data/btcusdc_1h_365d_240528.parquet`). Pour chaque fichier, calcule SMA 50, EMA 21, RSI 14, MACD (12‑26‑9), Bandes de Bollinger, ATR 14, NATR 14. Enregistre le résultat dans un nouveau fichier Parquet préfixé par `ta_` (ex: `data/ta_btcusdc_1h_365d_240528.parquet`). | ```bash # S'assurer d'abord que les données historiques existent, ex:``` <br> ```python S1/historical.py --symbol BTCUSDC --interval 1h --days 365``` <br><br> ```bash # Calcule les indicateurs pour TOUS les fichiers correspondants dans data/:``` <br> ```python S2/indicators.py``` <br><br> ```bash # Pour forcer le recalcul si les fichiers TA existent déjà:``` <br> ```python S2/indicators.py --overwrite``` |
| `tests/test_indicators.py`| *Smoke‑test* : vérifie que le fichier TA existe, que les colonnes clés sont présentes et qu’il n’y a plus de NaN après la période d’amorçage.                                                                                                         | `pytest tests/test_indicators.py`                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **`streamlit_app.py`**  | *Application Interactive Streamlit* : Permet de **sélectionner un fichier de données techniques** (généré par `indicators.py`, ex: `ta_btcusdc_1h_365d_240528.parquet`) depuis le répertoire `data/`. Affiche un dashboard interactif avec : OHLCV, SMA 50, EMA 21, Bandes de Bollinger, RSI 14, MACD 12‑26‑9, ATR 14 & NATR 14 %, et le volume. Permet une sélection flexible de la plage de dates via des `DatePicker` et des boutons de présélection rapide. | ```bash # Lancer l'application Streamlit (assurez-vous que S2/streamlit_app.py est le bon chemin):``` <br> ```streamlit run S2/streamlit_app.py```                                                                                                                                                                                                                                                                                                |

## Sprint S3 - Analyse de Sentiment via LLM

| Fichier               | Objectif / Rôle                                                                                                                                                                                                                         | Commande principale                                                                                                                                                                                                                                                                                                                                                                                                                   |
| :-------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **`ingest_news.py`**  | Récupère les actualités (titres, métadonnées) depuis l'API CryptoPanic pour des **cryptomonnaies spécifiées** (ex: `BTC`, `ETH`), sur une **période donnée** (ex: dernières 24h) et un **type de contenu** (ex: `news`). Sauvegarde les données brutes dans un fichier CSV (ex: `data/BTC_news_news_YYYYMMDD.csv`). Nécessite une clé API CryptoPanic dans le fichier `.env`. | ```bash # Pour les actualités Bitcoin des dernières 24h (défaut):``` <br> ```python S3/ingest_news.py``` <br><br> ```bash # Pour les actualités Ethereum & Cardano, type "media", dernières 48h, max 5 pages API:``` <br> ```python S3/ingest_news.py --currencies ETH,ADA --kind media --hours 48 --max_pages 5``` <br><br> *(S'assurer que `CRYPTOPANIC_API_KEY` est dans `.env`)* |
| `sentiment.py`        | *À définir* : Pipeline qui lit les actualités brutes (issues de `ingest_news.py`), interroge un LLM pour classifier le sentiment (bullish/neutral/bearish) de chaque titre, et produit un `sentiment_score` horodaté. | *Commande à définir*                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `tests/test_sentiment.py` | *À définir* : Tests pour `ingest_news.py` (ex: création fichier) et `sentiment.py` (ex: structure du score).                                                                                                                             | `pytest tests/test_sentiment.py`                                                                                                                                                                                                                                                                                                                                                                                                       |


## Feuille de Route (Roadmap)

| Sprint             | Objectif principal                                                                                      | Livrables clés                                                                                                                                       |
| :----------------- | :------------------------------------------------------------------------------------------------------ | :--------------------------------------------------------------------------------------------------------------------------------------------------- |
| **S0 — Bootstrap** | Poser l’environnement : repo Git, venv Python 3.12, dépendances de base, README, clés API dans `.env`.     | • Repo initial<br>• README (+ archi)<br>• Smoke‑test imports                                                                                        |
| **S1 — Collecte données** | Obtenir l’historique (configurable) + flux temps réel via Binance.                                       | • `historical.py` (REST, **nom de fichier avec date**)<br>• `streamer.py` (WS raw, SQLite)<br>• Parquets (ex: **`btcusdc_1h_365d_YYMMDD.parquet`**) & DB<br>• Tests de remplissage |
| **S2 — Indicateurs techniques & Visualisation** | Calculer les indicateurs et créer un dataset enrichi. Visualisation interactive.                        | • `indicators.py` (**scanne et traite tous les fichiers `_YYMMDD.parquet`**)<br>• Parquet *_ta* (ex: **`ta_btcusdc_1h_365d_YYMMDD.parquet`**)<br>• `streamlit_app.py` (Dashboard interactif)<br>• Tests indicateurs |
| **S3 — Sentiment LLM** | Pipeline qui **récupère les actualités crypto**, les classe via LLM (bullish/neutral/bearish), produit un `sentiment_score`. | • **`ingest_news.py`** (CryptoPanic API)<br>• `sentiment.py` (LLM classification)<br>• CSV d'actualités brutes<br>• Parquet sentiment<br>• Tests classification |
| S4 — Fusion signaux  | Combiner règles TA + sentiment pour générer des signaux d’achat/vente.                                   | • `decision.py` (rules YAML)<br>• Tests unitaires règles                                                                                              |
| S5 — Backtesting     | Évaluer la stratégie sur plusieurs années ; métriques : CAGR, Sharpe, Max DD.                             | • `backtest.py` (vectorbt)<br>• Rapport HTML/Notebook<br>• Script Optuna hyper‑param                                                                 |
| S6 — Gestion du risque | Position sizing + drawdown kill‑switch.                                                                 | • `risk.py`<br>• Tests de stress<br>• Alertes webhook                                                                                                |
| S7 — Paper‑trading   | Exécuter la strat sur le testnet Binance, journaliser les ordres.                                         | • `executor.py` (testnet)<br>• Log JSON + alertes                                                                                                   |
| S8 — Production locale 24/7 | Service de trading réel (spot/marge) tournant en continu sur Mac/VPS.                                  | • Script daemon + auto‑restart<br>• Dashboard Streamlit (étendu)                                                                                     |
| S9 — Durcissement & Cloud | Dockerisation, déploiement sur serveur, monitoring Prometheus/Grafana.                                  | • `Dockerfile` + docker‑compose<br>• Grafana dashboards                                                                                             |